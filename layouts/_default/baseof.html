<!DOCTYPE html>
<html lang="{{ with .Site.LanguageCode }}{{ . }}{{ else }}en{{ end }}">
  {{- partial "head.html" . -}}
  <body id="top"class="wrapper">
      {{ partial "header.html" . }}
    <main id="main-content" {{ if ne .Layout "lightbox" }}class="flex-grow-1"{{ end }}>
      {{- block "main" . }}{{- end }}
    </main>
    {{- block "footer" . }}{{- end }}
    <script src="https://cdn.jsdelivr.net/npm/@studio-freight/lenis@1.0.42/bundled/lenis.min.js" crossorigin="anonymous"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function(){
        try{
          if (window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
          if (typeof window.Lenis === 'function') {
            // Match the manifesto site's defaults as closely as possible
            var lenis = new window.Lenis({ lerp: 0.10, smoothWheel: true, smoothTouch: false, wheelMultiplier: 1 });
            function raf(t){ lenis.raf(t); requestAnimationFrame(raf); }
            requestAnimationFrame(raf);
          } else {
            // Fallback inertial scroll (desktop only)
            if ('ontouchstart' in window) return;
            var html = document.documentElement;
            var target = window.scrollY || window.pageYOffset;
            var current = target;
            var ticking = false;
            html.classList.add('lenis','lenis-smooth');
            function clamp(v, min, max){ return Math.max(min, Math.min(max, v)); }
            function onWheel(e){
              if (e.ctrlKey) return; // let zoom
              e.preventDefault();
              var max = html.scrollHeight - window.innerHeight;
              var mult = 1; // match Lenis default normalization
              target = clamp(target + e.deltaY * mult, 0, max);
              if (!ticking) requestAnimationFrame(step), ticking = true;
            }
            function step(){
              var diff = target - current;
              // LERP ~0.10 similar to Lenis default
              current += diff * 0.10;
              window.scrollTo(0, current);
              if (Math.abs(diff) > 0.5) {
                requestAnimationFrame(step);
              } else {
                window.scrollTo(0, target);
                ticking = false;
              }
            }
            window.addEventListener('wheel', onWheel, { passive: false });
          }
        }catch(e){ console.warn('Lenis init error', e); }
      });
    </script>
  </body>
</html>


